<#
    .SYNOPSIS
        Provisions VM as a Kubernetes agent.

    .DESCRIPTION
        Provisions VM as a Kubernetes agent.

        The parameters passed in are required, and will vary per-deployment.

        Notes on modifying this file:
        - This file extension is PS1, but it is actually used as a template from pkg/engine/template_generator.go
        - All of the lines that have braces in them will be modified. Please do not change them here, change them in the Go sources
        - Single quotes are forbidden, they are reserved to delineate the different members for the ARM template concat() call
#>
[CmdletBinding(DefaultParameterSetName="Standard")]
param(
    [string]
    [ValidateNotNullOrEmpty()]
    $MasterIP,

    [parameter()]
    [ValidateNotNullOrEmpty()]
    $KubeDnsServiceIp,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $MasterFQDNPrefix,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $Location,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AgentKey,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientId,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $AADClientSecret, # base64

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $NetworkAPIVersion,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $TargetEnvironment,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $LogFile,

    [parameter(Mandatory=$true)]
    [ValidateNotNullOrEmpty()]
    $CSEResultFilePath,

    [string]
    $UserAssignedClientID
)
# Do not parse the start time from $LogFile to simplify the logic
$StartTime=Get-Date
$global:ExitCode=0
$global:ErrorMessage=""

# These globals will not change between nodes in the same cluster, so they are not
# passed as powershell parameters

## SSH public keys to add to authorized_keys
$global:SSHKeys = @( "testsshkey" )

## Certificates generated by aks-engine
$global:CACertificate = ""
$global:AgentCertificate = ""

## Download sources provided by aks-engine
$global:KubeBinariesPackageSASURL = "https://acs-mirror.azureedge.net/kubernetes/v1.19.0/windowszip/v1.19.0-1int.zip"
$global:WindowsKubeBinariesURL = ""
$global:KubeBinariesVersion = "1.19.0"
$global:ContainerdUrl = "https://k8swin.blob.core.windows.net/k8s-windows/containerd/containerplat-aks-test-0.0.8.zip"
$global:ContainerdSdnPluginUrl = ""

## Docker Version
$global:DockerVersion = "19.03.14"

## ContainerD Usage
$global:ContainerRuntime = "docker"
$global:DefaultContainerdWindowsSandboxIsolation = "process"
$global:ContainerdWindowsRuntimeHandlers = ""

## VM configuration passed by Azure
$global:WindowsTelemetryGUID = "fb801154-36b9-41bc-89c2-f4d4f05472b0"

$global:TenantId = "tenantID"

$global:SubscriptionId = "subID"
$global:ResourceGroup = "resourceGroupName"
$global:VmType = "vmss"
$global:SubnetName = "aks-subnet"
# NOTE: MasterSubnet is still referenced by `kubeletstart.ps1` and `windowsnodereset.ps1`
# for case of Kubenet
$global:MasterSubnet = ""
$global:SecurityGroupName = "aks-agentpool-36873793-nsg"
$global:VNetName = "aks-vnet-36873793"
$global:RouteTableName = "aks-agentpool-36873793-routetable"
$global:PrimaryAvailabilitySetName = ""
$global:PrimaryScaleSetName = "akswpool2"

$global:KubeClusterCIDR = "10.240.0.0/16"
$global:KubeServiceCIDR = "10.0.0.0/16"
$global:VNetCIDR = "10.0.0.0/8"

$global:KubeletNodeLabels = "kubernetes.azure.com/role=agent,agentpool=wpool2,storageprofile=managed,storagetier=Premium_LRS,kubernetes.azure.com/cluster=resourceGroupName,kubernetes.azure.com/node-image-version=AKSWindows-2019-17763.1577.201111"

$global:KubeletConfigArgs = @( "--address=0.0.0.0", "--anonymous-auth=false", "--authentication-token-webhook=true", "--authorization-mode=Webhook", "--azure-container-registry-config=c:\k\azure.json", "--cgroups-per-qos=false", "--client-ca-file=c:\k\ca.crt", "--cloud-config=c:\k\azure.json", "--cloud-provider=azure", "--cluster-dns=10.0.0.10", "--cluster-domain=cluster.local", "--enforce-node-allocatable=", "--event-qps=0", "--eviction-hard=", "--feature-gates=RotateKubeletServerCertificate=true", "--hairpin-mode=promiscuous-bridge", "--image-gc-high-threshold=85", "--image-gc-low-threshold=80", "--image-pull-progress-deadline=20m", "--keep-terminated-pod-volumes=false", "--kube-reserved=cpu=100m,memory=1843Mi", "--kubeconfig=c:\k\config", "--max-pods=30", "--network-plugin=cni", "--node-status-update-frequency=10s", "--non-masquerade-cidr=0.0.0.0/0", "--pod-infra-container-image=kubletwin/pause", "--pod-max-pids=-1", "--read-only-port=0", "--resolv-conf=""", "--rotate-certificates=false", "--streaming-connection-idle-timeout=4h", "--system-reserved=memory=2Gi", "--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" )

$global:KubeproxyFeatureGates = @( "WinDSR=true", "WinOverlay=false" )

$global:UseManagedIdentityExtension = "false"
$global:UseInstanceMetadata = "true"

$global:LoadBalancerSku = "Standard"
$global:ExcludeMasterFromStandardLB = "true"


# Windows defaults, not changed by aks-engine
$global:CacheDir = "c:\akse-cache"
$global:KubeDir = "c:\k"
$global:HNSModule = [Io.path]::Combine("$global:KubeDir", "hns.psm1")

$global:KubeDnsSearchPath = "svc.cluster.local"

$global:CNIPath = [Io.path]::Combine("$global:KubeDir", "cni")
$global:NetworkMode = "L2Bridge"
$global:CNIConfig = [Io.path]::Combine($global:CNIPath, "config", "`$global:NetworkMode.conf")
$global:CNIConfigPath = [Io.path]::Combine("$global:CNIPath", "config")


$global:AzureCNIDir = [Io.path]::Combine("$global:KubeDir", "azurecni")
$global:AzureCNIBinDir = [Io.path]::Combine("$global:AzureCNIDir", "bin")
$global:AzureCNIConfDir = [Io.path]::Combine("$global:AzureCNIDir", "netconf")

# Azure cni configuration
# $global:NetworkPolicy = "" # BUG: unused
$global:NetworkPlugin = "azure"
$global:VNetCNIPluginsURL = "https://acs-mirror.azureedge.net/azure-cni/v1.1.3/binaries/azure-vnet-cni-singletenancy-windows-amd64-v1.1.3.zip"
$global:IsDualStackEnabled = $false

# Telemetry settings
$global:EnableTelemetry = [System.Convert]::ToBoolean("false");
$global:TelemetryKey = "";

# CSI Proxy settings
$global:EnableCsiProxy = [System.Convert]::ToBoolean("false");
$global:CsiProxyUrl = "";

# Hosts Config Agent settings
$global:EnableHostsConfigAgent = [System.Convert]::ToBoolean("false");

$global:ProvisioningScriptsPackageUrl = "https://acs-mirror.azureedge.net/aks-engine/windows/provisioning/signedscripts-v0.0.4.zip";

# PauseImage
$global:WindowsPauseImageURL = "mcr.microsoft.com/oss/kubernetes/pause:1.4.0";
$global:AlwaysPullWindowsPauseImage = [System.Convert]::ToBoolean("true");

# Calico
$global:WindowsCalicoPackageURL = "";

# GMSAv2
$global:WindowsGMSAv2PackageURL = "";

# TLS Bootstrap Token
$global:TLSBootstrapToken = ""

# Base64 representation of ZIP archive
$zippedFiles = "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"

# Extract ZIP from script
[io.file]::WriteAllBytes("scripts.zip", [System.Convert]::FromBase64String($zippedFiles))
Expand-Archive scripts.zip -DestinationPath "C:\\AzureData\\"

# Dot-source scripts with functions that are called in this script
. c:\AzureData\windows\kuberneteswindowsfunctions.ps1
. c:\AzureData\windows\windowsconfigfunc.ps1
. c:\AzureData\windows\windowskubeletfunc.ps1
. c:\AzureData\windows\windowscnifunc.ps1
. c:\AzureData\windows\windowsazurecnifunc.ps1
. c:\AzureData\windows\windowscsiproxyfunc.ps1
. c:\AzureData\windows\windowsinstallopensshfunc.ps1
. c:\AzureData\windows\windowscontainerdfunc.ps1
. c:\AzureData\windows\windowshostsconfigagentfunc.ps1
. c:\AzureData\windows\windowscalicofunc.ps1
. c:\AzureData\windows\windowscsehelper.ps1

$useContainerD = ($global:ContainerRuntime -eq "containerd")
$global:KubeClusterConfigPath = "c:\k\kubeclusterconfig.json"
$fipsEnabled = [System.Convert]::ToBoolean("false")

try
{
    # Set to false for debugging.  This will output the start script to
    # c:\AzureData\CustomDataSetupScript.log, and then you can RDP
    # to the windows machine, and run the script manually to watch
    # the output.
    if ($true) {
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AADClientId $AADClientId -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"

        if ($global:EnableTelemetry) {
            $global:globalTimer = [System.Diagnostics.Stopwatch]::StartNew()

            $configAppInsightsClientTimer = [System.Diagnostics.Stopwatch]::StartNew()
            # Get app insights binaries and set up app insights client
            Create-Directory -FullPath c:\k\appinsights -DirectoryUsage "storing appinsights"
            DownloadFileOverHttp -Url "https://globalcdn.nuget.org/packages/microsoft.applicationinsights.2.11.0.nupkg" -DestinationPath "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip"
            Expand-Archive -Path "c:\k\appinsights\microsoft.applicationinsights.2.11.0.zip" -DestinationPath "c:\k\appinsights"
            $appInsightsDll = "c:\k\appinsights\lib\net46\Microsoft.ApplicationInsights.dll"
            [Reflection.Assembly]::LoadFile($appInsightsDll)
            $conf = New-Object "Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration"
            $conf.DisableTelemetry = -not $global:EnableTelemetry
            $conf.InstrumentationKey = $global:TelemetryKey
            $global:AppInsightsClient = New-Object "Microsoft.ApplicationInsights.TelemetryClient"($conf)

            $global:AppInsightsClient.Context.Properties["correlation_id"] = New-Guid
            $global:AppInsightsClient.Context.Properties["cri"] = $global:ContainerRuntime
            # TODO: Update once containerd versioning story is decided
            $global:AppInsightsClient.Context.Properties["cri_version"] = if ($global:ContainerRuntime -eq "docker") { $global:DockerVersion } else { "" }
            $global:AppInsightsClient.Context.Properties["k8s_version"] = $global:KubeBinariesVersion
            $global:AppInsightsClient.Context.Properties["lb_sku"] = $global:LoadBalancerSku
            $global:AppInsightsClient.Context.Properties["location"] = $Location
            $global:AppInsightsClient.Context.Properties["os_type"] = "windows"
            $global:AppInsightsClient.Context.Properties["os_version"] = Get-WindowsVersion
            $global:AppInsightsClient.Context.Properties["network_plugin"] = $global:NetworkPlugin
            $global:AppInsightsClient.Context.Properties["network_plugin_version"] = Get-CniVersion
            $global:AppInsightsClient.Context.Properties["network_mode"] = $global:NetworkMode
            $global:AppInsightsClient.Context.Properties["subscription_id"] = $global:SubscriptionId

            $vhdId = ""
            if (Test-Path "c:\vhd-id.txt") {
                $vhdId = Get-Content "c:\vhd-id.txt"
            }
            $global:AppInsightsClient.Context.Properties["vhd_id"] = $vhdId

            $imdsProperties = Get-InstanceMetadataServiceTelemetry
            foreach ($key in $imdsProperties.keys) {
                $global:AppInsightsClient.Context.Properties[$key] = $imdsProperties[$key]
            }

            $configAppInsightsClientTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Config-AppInsightsClient", $configAppInsightsClientTimer.Elapsed.TotalSeconds)
        }

        # Install OpenSSH if SSH enabled
        $sshEnabled = [System.Convert]::ToBoolean("true")

        if ( $sshEnabled ) {
            Write-Log "Install OpenSSH"
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-OpenSSH -SSHKeys $SSHKeys
            if ($global:EnableTelemetry) {
                $installOpenSSHTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-OpenSSH", $installOpenSSHTimer.Elapsed.TotalSeconds)
            }
        }

        Write-Log "Apply telemetry data setting"
        Set-TelemetrySetting -WindowsTelemetryGUID $global:WindowsTelemetryGUID

        Write-Log "Resize os drive if possible"
        if ($global:EnableTelemetry) {
            $resizeTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        Resize-OSDrive
        if ($global:EnableTelemetry) {
            $resizeTimer.Stop()
            $global:AppInsightsClient.TrackMetric("Resize-OSDrive", $resizeTimer.Elapsed.TotalSeconds)
        }

        Write-Log "Initialize data disks"
        Initialize-DataDisks

        Write-Log "Create required data directories as needed"
        Initialize-DataDirectories

        Create-Directory -FullPath "c:\k"
        Get-ProvisioningScripts

        Write-KubeClusterConfig -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp

        Write-Log "Download kubelet binaries and unzip"
        Get-KubePackage -KubeBinariesSASURL $global:KubeBinariesPackageSASURL

        # This overwrites the binaries that are downloaded from the custom packge with binaries.
        # The custom package has a few files that are necessary for future steps (nssm.exe)
        # this is a temporary work around to get the binaries until we depreciate
        # custom package and nssm.exe as defined in aks-engine#3851.
        if ($global:WindowsKubeBinariesURL){
            Write-Log "Overwriting kube node binaries from $global:WindowsKubeBinariesURL"
            Get-KubeBinaries -KubeBinariesURL $global:WindowsKubeBinariesURL
        }

        if ($useContainerD) {
            Write-Log "Installing ContainerD"
            if ($global:EnableTelemetry) {
                $containerdTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            $cniBinPath = $global:AzureCNIBinDir
            $cniConfigPath = $global:AzureCNIConfDir
            if ($global:NetworkPlugin -eq "kubenet") {
                $cniBinPath = $global:CNIPath
                $cniConfigPath = $global:CNIConfigPath
            }
            Install-Containerd -ContainerdUrl $global:ContainerdUrl -CNIBinDir $cniBinPath -CNIConfDir $cniConfigPath -KubeDir $global:KubeDir
            if ($global:EnableTelemetry) {
                $containerdTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-ContainerD", $containerdTimer.Elapsed.TotalSeconds)
            }
        } else {
            Write-Log "Install docker"
            if ($global:EnableTelemetry) {
                $dockerTimer = [System.Diagnostics.Stopwatch]::StartNew()
            }
            Install-Docker -DockerVersion $global:DockerVersion
            Set-DockerLogFileOptions
            if ($global:EnableTelemetry) {
                $dockerTimer.Stop()
                $global:AppInsightsClient.TrackMetric("Install-Docker", $dockerTimer.Elapsed.TotalSeconds)
            }
        }

        # For AKSClustomCloud, TargetEnvironment must be set to AzureStackCloud
        Write-Log "Write Azure cloud provider config"
        Write-AzureConfig `
            -KubeDir $global:KubeDir `
            -AADClientId $AADClientId `
            -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
            -TenantId $global:TenantId `
            -SubscriptionId $global:SubscriptionId `
            -ResourceGroup $global:ResourceGroup `
            -Location $Location `
            -VmType $global:VmType `
            -SubnetName $global:SubnetName `
            -SecurityGroupName $global:SecurityGroupName `
            -VNetName $global:VNetName `
            -RouteTableName $global:RouteTableName `
            -PrimaryAvailabilitySetName $global:PrimaryAvailabilitySetName `
            -PrimaryScaleSetName $global:PrimaryScaleSetName `
            -UseManagedIdentityExtension $global:UseManagedIdentityExtension `
            -UserAssignedClientID $UserAssignedClientID `
            -UseInstanceMetadata $global:UseInstanceMetadata `
            -LoadBalancerSku $global:LoadBalancerSku `
            -ExcludeMasterFromStandardLB $global:ExcludeMasterFromStandardLB `
            -TargetEnvironment "AzureStackCloud" 

        # we borrow the logic of AzureStackCloud to achieve AKSCustomCloud. 
        # In case of AKSCustomCloud, customer cloud env will be loaded from azurestackcloud.json 
        
        $azureStackConfigFile = [io.path]::Combine($global:KubeDir, "azurestackcloud.json")
        $envJSON = "eyJOYW1lIjoiQXp1cmVTdGFja0Nsb3VkIiwibWNyVVJMIjoibWNyLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQiLCJyZXBvRGVwb3RFbmRwb2ludCI6Imh0dHBzOi8vcmVwb2RlcG90LmF6dXJlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvdWJ1bnR1IiwibWFuYWdlbWVudFBvcnRhbFVSTCI6Imh0dHBzOi8vcG9ydGFsLmF6dXJlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwic2VydmljZU1hbmFnZW1lbnRFbmRwb2ludCI6Imh0dHBzOi8vbWFuYWdlbWVudC5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwicmVzb3VyY2VNYW5hZ2VyRW5kcG9pbnQiOiJodHRwczovL21hbmFnZW1lbnQuYXp1cmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJhY3RpdmVEaXJlY3RvcnlFbmRwb2ludCI6Imh0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwia2V5VmF1bHRFbmRwb2ludCI6Imh0dHBzOi8vdmF1bHQuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJncmFwaEVuZHBvaW50IjoiaHR0cHM6Ly9ncmFwaC5jbG91ZGFwaS5taWNyb3NvZnQuZmFrZWN1c3RvbWNsb3VkLyIsInN0b3JhZ2VFbmRwb2ludFN1ZmZpeCI6ImNvcmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsInNxbERhdGFiYXNlRE5TU3VmZml4IjoiZGF0YWJhc2UuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsImtleVZhdWx0RE5TU3VmZml4IjoidmF1bHQuY2xvdWRhcGkubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZCIsInJlc291cmNlTWFuYWdlclZNRE5TU3VmZml4IjoiY2xvdWRhcHAuYXp1cmUubWljcm9zb2Z0LmZha2VjdXN0b21jbG91ZC8iLCJjb250YWluZXJSZWdpc3RyeUROU1N1ZmZpeCI6Ii5henVyZWNyLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQiLCJjb3Ntb3NEQkROU1N1ZmZpeCI6ImRvY3VtZW50cy5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwidG9rZW5BdWRpZW5jZSI6Imh0dHBzOi8vbWFuYWdlbWVudC5jb3JlLm1pY3Jvc29mdC5mYWtlY3VzdG9tY2xvdWQvIiwicmVzb3VyY2VJZGVudGlmaWVycyI6e319"
        [io.file]::WriteAllBytes($azureStackConfigFile, [System.Convert]::FromBase64String($envJSON))

        Get-CACertificates
        

        Write-Log "Write ca root"
        Write-CACert -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir

        if ($global:EnableCsiProxy) {
            New-CsiProxyService -CsiProxyPackageUrl $global:CsiProxyUrl -KubeDir $global:KubeDir
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Write TLS bootstrap kubeconfig"
            Write-BootstrapKubeConfig -CACertificate $global:CACertificate `
                -KubeDir $global:KubeDir `
                -MasterFQDNPrefix $MasterFQDNPrefix `
                -MasterIP $MasterIP `
                -TLSBootstrapToken $global:TLSBootstrapToken

            # NOTE: we need kubeconfig to setup calico even if TLS bootstrapping is enabled
            #       This kubeconfig will deleted after calico installation.
            # TODO(hbc): once TLS bootstrap is fully enabled, remove this if block
            Write-Log "Write temporary kube config"
        } else {
            Write-Log "Write kube config"
        }

        Write-KubeConfig -CACertificate $global:CACertificate `
            -KubeDir $global:KubeDir `
            -MasterFQDNPrefix $MasterFQDNPrefix `
            -MasterIP $MasterIP `
            -AgentKey $AgentKey `
            -AgentCertificate $global:AgentCertificate

        if ($global:EnableHostsConfigAgent) {
             Write-Log "Starting hosts config agent"
             New-HostsConfigService
         }

        Write-Log "Create the Pause Container kubletwin/pause"
        if ($global:EnableTelemetry) {
            $infraContainerTimer = [System.Diagnostics.Stopwatch]::StartNew()
        }
        New-InfraContainer -KubeDir $global:KubeDir -ContainerRuntime $global:ContainerRuntime
        if ($global:EnableTelemetry) {
            $infraContainerTimer.Stop()
            $global:AppInsightsClient.TrackMetric("New-InfraContainer", $infraContainerTimer.Elapsed.TotalSeconds)
        }

        if (-not (Test-ContainerImageExists -Image "kubletwin/pause" -ContainerRuntime $global:ContainerRuntime)) {
            Write-Log "Could not find container with name kubletwin/pause"
            if ($useContainerD) {
                $o = ctr -n k8s.io image list
                Write-Log $o
            } else {
                $o = docker image list
                Write-Log $o
            }
            Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_PAUSE_IMAGE_NOT_EXIST -ErrorMessage "kubletwin/pause container does not exist!"
        }

        Write-Log "Configuring networking with NetworkPlugin:$global:NetworkPlugin"

        # Configure network policy.
        Get-HnsPsm1 -HNSModule $global:HNSModule
        Import-Module $global:HNSModule

        if ($global:NetworkPlugin -eq "azure") {
            Write-Log "Installing Azure VNet plugins"
            Install-VnetPlugins -AzureCNIConfDir $global:AzureCNIConfDir `
                -AzureCNIBinDir $global:AzureCNIBinDir `
                -VNetCNIPluginsURL $global:VNetCNIPluginsURL

            Set-AzureCNIConfig -AzureCNIConfDir $global:AzureCNIConfDir `
                -KubeDnsSearchPath $global:KubeDnsSearchPath `
                -KubeClusterCIDR $global:KubeClusterCIDR `
                -KubeServiceCIDR $global:KubeServiceCIDR `
                -VNetCIDR $global:VNetCIDR `
                -IsDualStackEnabled $global:IsDualStackEnabled

            if ($TargetEnvironment -ieq "AzureStackCloud") {
                GenerateAzureStackCNIConfig `
                    -TenantId $global:TenantId `
                    -SubscriptionId $global:SubscriptionId `
                    -ResourceGroup $global:ResourceGroup `
                    -AADClientId $AADClientId `
                    -KubeDir $global:KubeDir `
                    -AADClientSecret $([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($AADClientSecret))) `
                    -NetworkAPIVersion $NetworkAPIVersion `
                    -AzureEnvironmentFilePath $([io.path]::Combine($global:KubeDir, "azurestackcloud.json")) `
                    -IdentitySystem "azure_ad"
            }
        }
        elseif ($global:NetworkPlugin -eq "kubenet") {
            Write-Log "Fetching additional files needed for kubenet"
            if ($useContainerD) {
                # TODO: CNI may need to move to c:\program files\containerd\cni\bin with ContainerD
                Install-SdnBridge -Url $global:ContainerdSdnPluginUrl -CNIPath $global:CNIPath
            } else {
                Update-WinCNI -CNIPath $global:CNIPath
            }
        }

        New-ExternalHnsNetwork -IsDualStackEnabled $global:IsDualStackEnabled

        Install-KubernetesServices `
            -KubeDir $global:KubeDir `
            -ContainerRuntime $global:ContainerRuntime

        Get-LogCollectionScripts

        Write-Log "Disable Internet Explorer compat mode and set homepage"
        Set-Explorer

        Write-Log "Adjust pagefile size"
        Adjust-PageFileSize

        Write-Log "Start preProvisioning script"
        

        Write-Log "Update service failure actions"
        Update-ServiceFailureActions -ContainerRuntime $global:ContainerRuntime

        Enable-FIPSMode -FipsEnabled $fipsEnabled
        Install-GMSAv2Plugin -GMSAv2PackageURL $global:WindowsGMSAv2PackageURL

        Adjust-DynamicPortRange
        Register-LogsCleanupScriptTask
        Register-NodeResetScriptTask
        Register-NodeLabelSyncScriptTask
        Update-DefenderPreferences

        Check-APIServerConnectivity -MasterIP $MasterIP

        if ($global:WindowsCalicoPackageURL) {
            Write-Log "Start calico installation"
            Start-InstallCalico -RootDir "c:\" -KubeServiceCIDR $global:KubeServiceCIDR -KubeDnsServiceIp $KubeDnsServiceIp
        }

        if (Test-Path $CacheDir)
        {
            Write-Log "Removing aks-engine bits cache directory"
            Remove-Item $CacheDir -Recurse -Force
        }

        if ($global:EnableTelemetry) {
            $global:globalTimer.Stop()
            $global:AppInsightsClient.TrackMetric("TotalDuration", $global:globalTimer.Elapsed.TotalSeconds)
            $global:AppInsightsClient.Flush()
        }

        if ($global:TLSBootstrapToken) {
            Write-Log "Removing temporary kube config"
            $kubeConfigFile = [io.path]::Combine($KubeDir, "config")
            Remove-Item $kubeConfigFile
        }

        # Postpone restart-computer so we can generate CSE response before restarting computer
        Write-Log "Setup Complete, reboot computer"
        Postpone-RestartComputer
    }
    else
    {
        # keep for debugging purposes
        Write-Log ".\CustomDataSetupScript.ps1 -MasterIP $MasterIP -KubeDnsServiceIp $KubeDnsServiceIp -MasterFQDNPrefix $MasterFQDNPrefix -Location $Location -AgentKey $AgentKey -AADClientId $AADClientId -AADClientSecret $AADClientSecret -NetworkAPIVersion $NetworkAPIVersion -TargetEnvironment $TargetEnvironment"
    }
}
catch
{
    if ($global:EnableTelemetry) {
        $exceptionTelemtry = New-Object "Microsoft.ApplicationInsights.DataContracts.ExceptionTelemetry"
        $exceptionTelemtry.Exception = $_.Exception
        $global:AppInsightsClient.TrackException($exceptionTelemtry)
        $global:AppInsightsClient.Flush()
    }

    # Set-ExitCode will exit with the specified ExitCode immediately and not be caught by this catch block
    # Ideally all exceptions will be handled and no exception will be thrown.
    Set-ExitCode -ExitCode $global:WINDOWS_CSE_ERROR_UNKNOWN -ErrorMessage $_
}
finally
{
    # Generate CSE result so it can be returned as the CSE response in csecmd.ps1
    $ExecutionDuration=$(New-Timespan -Start $StartTime -End $(Get-Date))
    Write-Log "CSE ExecutionDuration: $ExecutionDuration"

    # Windows CSE does not return any error message so we cannot generate below content as the response
    # $JsonString = "ExitCode: `"{0}`", Output: `"{1}`", Error: `"{2}`", ExecDuration: `"{3}`"" -f $global:ExitCode, "", $global:ErrorMessage, $ExecutionDuration.TotalSeconds
    Write-Log "Generate CSE result to $CSEResultFilePath : $global:ExitCode"
    echo $global:ExitCode | Out-File -FilePath $CSEResultFilePath -Encoding utf8
}

